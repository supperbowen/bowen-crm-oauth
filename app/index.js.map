{"version":3,"sources":["../src/index.js"],"names":["koaRouter","require","bodypraser","mount","oauthserver","model","Koa","app","oauth","grants","debug","use","middleware","post","grant","get","body","routes","allowedMethods","mongoose","connect","dburl","listen","console","log"],"mappings":";;AAAA;;AAEA;;;;;;AADA,IAAIA,YAAY,IAAIC,OAAJ,CAAY,YAAZ,GAAhB;;;AAGA,IAAMC,aAAaD,QAAQ,gBAAR,CAAnB;AACA,IAAME,QAAQF,QAAQ,WAAR,CAAd;AACA,IAAMG,cAAcH,QAAQ,kBAAR,CAApB;AACA,IAAMI,QAAQJ,QAAQ,0BAAR,CAAd;;AAEA,IAAMK,MAAML,QAAQ,KAAR,CAAZ;AACA,IAAMM,MAAM,IAAID,GAAJ,EAAZ;;AAEAC,IAAIC,KAAJ,GAAYJ,YAAY;AACvBC,QAAOA,KADgB,EACT;AACdI,SAAQ,CAAC,UAAD,CAFe;AAGvBC,QAAO;AAHgB,CAAZ,CAAZ;;AAMAH,IAAII,GAAJ,CAAQT,YAAR;;AAEA;AACAK,IAAII,GAAJ,CAAQR,MAAM,SAAN,EAAiBH,UAAUY,UAAV,EAAjB,CAAR;;AAEA;AACAZ,UAAUa,IAAV,CAAe,QAAf,EAAyBN,IAAIC,KAAJ,CAAUM,KAAV,EAAzB;AACA;;AAEAd,UAAUe,GAAV,CAAc,OAAd,EAAuB,YAAW;AACjC,MAAKC,IAAL,GAAY,cAAZ;AACA,CAFD;;AAIA;AACA;AACA;AACA;;AAEAT,IAAII,GAAJ,CAAQX,UAAUiB,MAAV,EAAR,EACEN,GADF,CACMX,UAAUkB,cAAV,EADN;;AAGA,IAAIC,WAAWlB,QAAQ,UAAR,CAAf;AACAkB,SAASC,OAAT,CAAiB,kBAAQC,KAAzB;;AAEAd,IAAIe,MAAJ,CAAW,IAAX;AACAC,QAAQC,GAAR,CAAY,yCAAZ","file":"index.js","sourcesContent":["import 'babel-polyfill';\r\nvar koaRouter = new require('koa-router')();\r\nimport context from './common/context';\r\n\r\nconst bodypraser = require('koa-bodyparser');\r\nconst mount = require('koa-mount');\r\nconst oauthserver = require('koa-oauth-server');\r\nconst model = require('./services/oauth.service');\r\n\r\nconst Koa = require('koa');\r\nconst app = new Koa();\r\n\r\napp.oauth = oauthserver({\r\n\tmodel: model, // See https://github.com/thomseddon/node-oauth2-server for specification\r\n\tgrants: ['password'],\r\n\tdebug: true\r\n});\r\n\r\napp.use(bodypraser());\r\n\r\n// Mount `oauth2` route prefix.\r\napp.use(mount('/oauth2', koaRouter.middleware()));\r\n\r\n// Register `/token` POST path on oauth router (i.e. `/oauth2/token`).\r\nkoaRouter.post('/token', app.oauth.grant());\r\n//app.use(app.oauth.authorise());\r\n\r\nkoaRouter.get('/test', function() {\r\n\tthis.body = 'hello world!';\r\n});\r\n\r\n// app.use(function *(next) {\r\n//   this.body = 'Secret area';\r\n//   yield next;\r\n// });\r\n\r\napp.use(koaRouter.routes())\r\n\t.use(koaRouter.allowedMethods());\r\n\r\nvar mongoose = require('mongoose');\r\nmongoose.connect(context.dburl);\r\n\r\napp.listen(8089);\r\nconsole.log('server started : http://localhost:8089/');\r\n"]}
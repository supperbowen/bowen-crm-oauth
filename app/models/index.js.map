{"version":3,"sources":["../../src/models/index.js"],"names":["module","exports","getAccessToken","bearerToken","console","log","findOne","accessToken","getClient","clientId","clientSecret","getRefreshToken","refreshToken","getUser","username","password","saveToken","token","client","user","accessTokenExpiresOn","id","refreshTokenExpiresOn","userId","save"],"mappings":";;AAGA;;;;AACA;;;;AACA;;;;;;AAEA;;;;AAIAA,OAAOC,OAAP,CAAeC,cAAf,2BAAgC,iBAAUC,WAAV;AAAA;AAAA;AAAA;AAAA;AAC/BC,aAAQC,GAAR,CAAY,qCAAqCF,WAArC,GAAmD,GAA/D;;AAD+B;AAAA,YAGlB,qBAAiBG,OAAjB,CAAyB;AACrCC,mBAAaJ;AADwB,MAAzB,CAHkB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAhC;;AAQA;;;;AAnBA;;;AAuBAH,OAAOC,OAAP,CAAeO,SAAf,2BAA2B,kBAAUC,QAAV,EAAoBC,YAApB;AAAA;AAAA;AAAA;AAAA;AAC1BN,aAAQC,GAAR,CAAY,6BAA6BI,QAA7B,GAAwC,kBAAxC,GAA6DC,YAA7D,GAA4E,GAAxF;;AAD0B;AAAA,YAGb,sBAAkBJ,OAAlB,CAA0B;AACtCG,gBAAUA,QAD4B;AAEtCC,oBAAcA;AAFwB,MAA1B,CAHa;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA3B;;AASA;;;;AAIAV,OAAOC,OAAP,CAAeU,eAAf,2BAAiC,kBAAUC,YAAV;AAAA;AAAA;AAAA;AAAA;AAChCR,aAAQC,GAAR,CAAY,uCAAuCO,YAAvC,GAAsD,GAAlE;;AADgC;AAAA,YAGnB,qBAAiBN,OAAjB,CAAyB;AACrCM,oBAAcA;AADuB,MAAzB,CAHmB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAjC;;AAQA;;;;AAIAZ,OAAOC,OAAP,CAAeY,OAAf,2BAAyB,kBAAUC,QAAV,EAAoBC,QAApB;AAAA;AAAA;AAAA;AAAA;AACxBX,aAAQC,GAAR,CAAY,2BAA2BS,QAA3B,GAAsC,cAAtC,GAAuDC,QAAvD,GAAkE,GAA9E;;AADwB;AAAA,YAGX,oBAAgBT,OAAhB,CAAwB;AACpCQ,gBAAUA,QAD0B;AAEpCC,gBAAUA;AAF0B,MAAxB,CAHW;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAzB;;AASA;;;;AAIAf,OAAOC,OAAP,CAAee,SAAf,2BAA2B,kBAAUC,KAAV,EAAiBC,MAAjB,EAAyBC,IAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAC1Bf,aAAQC,GAAR,CAAY,0BAA0BY,KAA1B,GAAkC,GAA9C;;AAEIV,gBAHsB,GAGR,yBAAqB;AACtCA,mBAAaU,MAAMV,WADmB;AAEtCa,4BAAsBH,MAAMG,oBAFU;AAGtCX,gBAAUS,OAAOG,EAHqB;AAItCT,oBAAcK,MAAML,YAJkB;AAKtCU,6BAAuBL,MAAMK,qBALS;AAMtCC,cAAQJ,KAAKE;AANyB,MAArB,CAHQ;AAAA;AAAA,YAYbd,YAAYiB,IAAZ,EAZa;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA3B","file":"index.js","sourcesContent":["/**\r\n * Module dependencies.\r\n */\r\nimport OAuthTokensModel from './oauth.token.model'\r\nimport OAuthUsersModel from './oauth.user.model';\r\nimport OAuthClientsModel from './oauth.client.model';\r\n\r\n/**\r\n * Get access token.\r\n */\r\n\r\nmodule.exports.getAccessToken = function*(bearerToken) {\r\n\tconsole.log('in getAccessToken (bearerToken: ' + bearerToken + ')');\r\n\r\n\treturn yield OAuthTokensModel.findOne({\r\n\t\taccessToken: bearerToken\r\n\t});\r\n};\r\n\r\n/**\r\n * Get client.\r\n */\r\n\r\nmodule.exports.getClient = function*(clientId, clientSecret) {\r\n\tconsole.log('in getClient (clientId: ' + clientId + ', clientSecret: ' + clientSecret + ')');\r\n\r\n\treturn yield OAuthClientsModel.findOne({\r\n\t\tclientId: clientId,\r\n\t\tclientSecret: clientSecret\r\n\t});\r\n};\r\n\r\n/**\r\n * Get refresh token.\r\n */\r\n\r\nmodule.exports.getRefreshToken = function*(refreshToken) {\r\n\tconsole.log('in getRefreshToken (refreshToken: ' + refreshToken + ')');\r\n\r\n\treturn yield OAuthTokensModel.findOne({\r\n\t\trefreshToken: refreshToken\r\n\t});\r\n};\r\n\r\n/*\r\n * Get user.\r\n */\r\n\r\nmodule.exports.getUser = function*(username, password) {\r\n\tconsole.log('in getUser (username: ' + username + ', password: ' + password + ')');\r\n\r\n\treturn yield OAuthUsersModel.findOne({\r\n\t\tusername: username,\r\n\t\tpassword: password\r\n\t});\r\n};\r\n\r\n/**\r\n * Save token.\r\n */\r\n\r\nmodule.exports.saveToken = function*(token, client, user) {\r\n\tconsole.log('in saveToken (token: ' + token + ')');\r\n\r\n\tvar accessToken = new OAuthTokensModel({\r\n\t\taccessToken: token.accessToken,\r\n\t\taccessTokenExpiresOn: token.accessTokenExpiresOn,\r\n\t\tclientId: client.id,\r\n\t\trefreshToken: token.refreshToken,\r\n\t\trefreshTokenExpiresOn: token.refreshTokenExpiresOn,\r\n\t\tuserId: user.id\r\n\t});\r\n\r\n\treturn yield accessToken.save();\r\n};\r\n"]}